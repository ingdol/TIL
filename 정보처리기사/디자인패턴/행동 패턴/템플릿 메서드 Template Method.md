# 템플릿 메서드 Template Method

[템플릿 메서드 패턴](https://refactoring.guru/ko/design-patterns/template-method)

## 의도

- 템플릿 메서드
    - 부모 클래스에서 알고리즘의 골격을 정의하지만
    - 해당 알고리즘의 구조를 변경하지 않고 자식 클래스들이 알고리즘의 특정 단계들을 오버라이드(재정의)할 수 있도록 하는 행동 디자인 패턴

![Untitled](%E1%84%90%E1%85%A6%E1%86%B7%E1%84%91%E1%85%B3%E1%86%AF%E1%84%85%E1%85%B5%E1%86%BA%20%E1%84%86%E1%85%A6%E1%84%89%E1%85%A5%E1%84%83%E1%85%B3%20Template%20Method%202df717d54c4945d2820052827671a7d5/Untitled.png)

## 문제

- 회사 문서들을 분석하는 데이터 마이닝 앱을 만든다고 가정
    - 앱에 다양한 형식(PDF, DOC, CSV)의 문서들을 제공하고 이러한 문서들에서 일관된 형식으로 의미 있는 데이터를 추출하려고 시도

![데이터 마이닝 클래스들에는 중복 코드가 많이 포함](%E1%84%90%E1%85%A6%E1%86%B7%E1%84%91%E1%85%B3%E1%86%AF%E1%84%85%E1%85%B5%E1%86%BA%20%E1%84%86%E1%85%A6%E1%84%89%E1%85%A5%E1%84%83%E1%85%B3%20Template%20Method%202df717d54c4945d2820052827671a7d5/Untitled%201.png)

데이터 마이닝 클래스들에는 중복 코드가 많이 포함

- 위 세 클래스 모두 유사한 코드가 많다는 것을 알게 됨
    - 다양한 데이터 형식들을 처리하는 코드는 클래스마다 완전히 다르지만 데이터 처리 및 분석을 위한 코드는 거의 같음
- 코드에는 작업을 처리하고 있는 클래스에 따라 적절한 행동들을 선택하는 조건문이 많이 있음
    - 세 처리 클래스에 전부 공통 인터페이스나 공통 기초 클래스가 있다면, 클라이언트 코드에서 조건문들을 제거하고 처리 객체에 메서드를 호출할 때 다형성을 사용할 수 있을 것임

## 해결책

- 템플릿 메서드 패턴
    - 알고리즘을 일련의 단계들로 나누고,
    - 이러한 단계들을 메서드들로 변환한 뒤,
    - 단일 템플릿 메서드 내부에 이러한 메서드들에 대한 일련의 호출을 너으라고 제안
    - 이러한 단계들은 `abstract`(추상)이거나 일부 디폴트(기본값) 구현을 가질 것임
- 알고리즘을 사용하기 위해
    - 클라이언트는 자신의 자식 클래스를 제공해야 하고
    - 모든 추상 단계를 구현해야 하며
    - 필요하다면(템플릿 메서드를 제외한) 선택적 단계 중 일부를 오버라이드(재정의)해야 함

- 데이터 마이닝 앱에서 어떻게 동작할까?
    - 세 가지 파싱 알고리즘들 모두를 위한 기초 클래스를 만들 수 있음
    - 기초 클래스는 다양한 문서 처리 단계들에 대한 일련의 호출들로 구성한 템플릿 메서드를 정의함

![템플릿 메서드는 알고리즘을 단계로 나누어 자식 클래스들이 위에 언급된 실제 메서드를 제외한 이 단계들을 오버라이드할 수 있도록 함](%E1%84%90%E1%85%A6%E1%86%B7%E1%84%91%E1%85%B3%E1%86%AF%E1%84%85%E1%85%B5%E1%86%BA%20%E1%84%86%E1%85%A6%E1%84%89%E1%85%A5%E1%84%83%E1%85%B3%20Template%20Method%202df717d54c4945d2820052827671a7d5/Untitled%202.png)

템플릿 메서드는 알고리즘을 단계로 나누어 자식 클래스들이 위에 언급된 실제 메서드를 제외한 이 단계들을 오버라이드할 수 있도록 함

- 처음에는 모든 단계를 `abstract` 로 선언하여 자식 클래스들이 이러한 메서드들에 대한 자체 구현을 제공하도록 강제할 수 있음
    - 위 앱에서는 자식 클래스들은 이미 필요한 모든 구현들을 가지고 있으므로, 메서드들의 시그니처들을 부모 클래스의 메서드들과 일치하도록 조정하는 것
- 이제 중복 코드를 제거하기 위해
    - 미가공 데이터 분석 및 보고서 작성과 같은 단계들의 구현은 매우 유사하므로 기초 클래스로 만들 필요가 있음
    - 그러면 자식 클래스들은 기초 클래스에서 이 코드를 공유할 수 있음

두 가지 유형의 단계

1. 모든 자식 클래스는 추상 단계들을 구현해야 함
2. 선택적 단계들에는 이미 어떤 디폴트(기본값) 구현이 있지만, 필요한 경우 이를 무시하고 오버라이드(재정의)할 수 있음
- 훅이라는 또 다른 유형의 단계가 있음
    - 훅은 몸체가 비어 있는 선택적 단계
    - 템플릿 메서드는 훅이 오버라이드 되지 않아도 작동함
    - 일반적으로 훅들은 알고리즘의 중요한 단계들의 전 또는 후에 배치되어 자식 클래스들에 알고리즘에 대한 추가 확장 지점들을 제공함

## 실제상황 적용

![일반적인 건축 계획은 클라이언트의 니즈에 더 잘 부합하도록 약간 변경될 수 있음](%E1%84%90%E1%85%A6%E1%86%B7%E1%84%91%E1%85%B3%E1%86%AF%E1%84%85%E1%85%B5%E1%86%BA%20%E1%84%86%E1%85%A6%E1%84%89%E1%85%A5%E1%84%83%E1%85%B3%20Template%20Method%202df717d54c4945d2820052827671a7d5/Untitled%203.png)

일반적인 건축 계획은 클라이언트의 니즈에 더 잘 부합하도록 약간 변경될 수 있음

- 템플릿 메서드 접근 방식은 대량 주택 건설에 사용할 수 있음
    - 표준 주택 건설을 위한 건축 계획에는 잠재적 주택 소유자가 결과 주택의 일부 세부 사항들을 조정할 수 있도록 하는 여러 확장 지점들이 포함될 수 있음
- 완성된 집이 다른 집들과 조금씨 다르도록 각 건축 단계는 약간씩 변경될 수 있음

## 구조

![Untitled](%E1%84%90%E1%85%A6%E1%86%B7%E1%84%91%E1%85%B3%E1%86%AF%E1%84%85%E1%85%B5%E1%86%BA%20%E1%84%86%E1%85%A6%E1%84%89%E1%85%A5%E1%84%83%E1%85%B3%20Template%20Method%202df717d54c4945d2820052827671a7d5/Untitled%204.png)

1. 추상 클래스
    - 알고리즘의 단계들의 역할을 하는 메서드들을 선언
        - 이러한 메서드를 특정 순서로 호출하는 실제 템플릿 메서드도 선언함
        - 단계들은 `abstract` 로 선언되거나 일부 디폴트 구현을 갖음
2. 구상 클래스
    - 모든 단계들을 오버라이드할 수 있지만
    - 템플릿 메서드 자체는 오버라이드 할 수 없음